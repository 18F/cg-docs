---
menu:
  main:
    parent: advanced
title: Custom Domains
---

# Custom Domains

Here's how to put your app on your project's custom domain name. For context, [Cloud Foundry's Routes and Domains documentation](https://docs.cloudfoundry.org/devguide/deploy-apps/routes-domains.html) explains the overall model and terminology that cloud.gov uses.

The [Manual Method](#manual-method) is available to all users. We've also developed a [Managed Service Method](#managed-service-method), but this is not automatically available to most users yet because it's in cloud.gov's GovCloud environment (if you need this, [let us know](/help/)).

Both of these methods support user access to your application over IPv6 if your DNS supports IPv6.

If you need to set up an app on a domain managed by GSA TTS, you may also be interested in [18F/dns](https://github.com/18F/dns).

## Manual Method

Send a request to cloud.gov support (cloud-gov-support@gsa.gov for any customer, or [#cloud-gov-support](https://18f.slack.com/messages/cloud-gov-support) for 18F staff) to tell us you want to set up a custom domain. Include your domain and org name.

We'll configure your org to make your domain available for use with that org, and we'll tell you the entry to put in your DNS. Next you'll set up your application route, as explained in the next section.

### Application Routes

Use your application manifest.yml to identify the domain where the application route should be created.

For example:

	---
	...
	- name: myapp
	  domain: domain.tld

That will create the route `myapp.domain.tld` for your application. Alternatively, you can specify a specific hostname for your app separate from the application name within CF. For example:

	---
	...
	- name: myapp
	  host: frontend
	  domain: domain.tld

That will create the route `frontend.domain.tld` for your application.

#### Hostless Routes

One common scenario is the need to redirect a delegated subdomain to a CF app. In this case, you've been delegated `app.parent.tld` for your CF-hosted app from the owners of `parent.tld`.

Let us know if you need this. Rather than create the `parent.tld` domain within CF, we can create the full `app.parent.tld` domain and map it to an application.

	cf create-domain ORGANIZATION app.parent.tld
	cf map-route myapp app.parent.tld

[API](http://apidocs.cloudfoundry.org/206/routes/associate_app_with_the_route.html)


## Managed Service Method

*Note: this is only available in cloud.gov's GovCloud environment.*

cloud.gov offers a managed service that allows you to forward a domain you control to a cloud.gov application using [AWS CloudFront](https://aws.amazon.com/cloudfront/). Traffic is encrypted using an SSL certificate generated by [Let's Encrypt](https://letsencrypt.org/).

1. Target the space your application is running in.

    ```bash
    $ cf target -o <org> -s <space>
    ```

1. Create a service instance.

    ```
    $ cf create-service cdn-route cdn-route my-cdn-route \
        -c '{"domain": "my.domain.gov", "origin": "my-app.apps.cloud.gov"}'

    Create in progress. Use 'cf services' or 'cf service my-cdn-route' to check operation status.
    ```

    If you have more than one domain you can pass a comma-delimited list to the `domain` parameter, just keep in mind that the broker will wait until all domains are CNAME'd:

    ```
    $ cf create-service cdn-route cdn-route my-cdn-route \
        -c '{"domain": "my.domain.gov,www.my.domain.gov", "origin": "my-app.apps.cloud.gov"}'

    Create in progress. Use 'cf services' or 'cf service my-cdn-route' to check operation status.
    ```

1. Get the DNS instructions.

    ```
    $ cf service my-cdn-route

    Last Operation
    Status: create in progress
    Message: Provisioning in progress; CNAME domain "my.domain.gov" to "d3kajwa62y9xrp.cloudfront.net."
    ```

1. Create/update your DNS configuration (including your IPv6 AAAA configuration if you need it).
1. Wait up to 30 minutes for the CloudFront distribution to be provisioned and the DNS changes to propagate.
1. Visit `my.domain.gov`, and see that you have a valid certificate (i.e. that visiting your site in a modern browser doesn't give you a certificate warning).

1. Add your domain as a Cloud Foundry domain (so that your apps can use it). To do this, follow the steps at [Manual Method]({{< relref "#manual-method" >}}), starting with sending a support request. (Along with letting us know your domain and org name, let us know you've set up a managed service.)
